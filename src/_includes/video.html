{% comment %}
    INFO
    - inline-template: https://vuejsdevelopers.com/2017/03/24/vue-js-component-templates/
    - stream is redudant on attrs - only playlist works

    TODO
    - test on live if feed triggers reload (it shouldn't for hash)

    <transition name="special-thumb-slider-entrance"></transition>
{% endcomment %}

<div id="vue-app" class="mb-4">

    {% capture live_stream %}
        {% if page.url contains 'live' %}
            live-stream="rtmp://streamer.swellnet.com.au/surfcams/snapper-rocks.stream"
            live-stream-image="http://static.swellnet.com.au/images/surfcams/snapper-rocks.jpg"
            live-stream-playlist="https://streamer.swellnet.com.au/surfcams/yamba.stream/playlist.m3u8"
        {% endif %}
    {% endcapture %}

    <!-- SURFCAM WIDGET -->
    <surfcam-widget {{ live_stream }} data-path="http://staging.swellnet.com.fe2.stg.swellnet.anchor.net.au/surfcam-replays/data/" surfcam-id="33" inline-template>
        <div>

            <!-- LIVE / REPLAYS TABS -->
            <div class="btn-tabs collapse-row-sm-only">
                {% unless page.user_type == 'public' %}
                    <span class="flag-wrapper flag-favourite-surfcam">
                        <a href="#" class="flag flag-action flag-link-normal" rel="nofollow">Set as favourite</a><span class="flag-throbber">&nbsp;</span>
                    </span>
                {% endunless %}
                <a class="btn-tab" :class="{active: feedType == 'replay'}" href="/surfcams/knights-replays/paid/">Replays</a>
                <a class="btn-tab" :class="{active: feedType == 'live'}"   href="/surfcams/knights-live/paid/">Live</a>
            </div>

            {% if page.url contains 'replays' or page.url == '/' %}
                <!-- WRAPPER -->
                <div class="custom-select-wrapper collapse-row-sm-only">

                    <!-- DATE-SELECT COMPONENT -->
                    <date-select :is-loading="feedLoading" v-model="date"></date-select>

                    <!-- TIME-SELECT COMPONENT -->
                    <time-select :is-loading="feedLoading" v-model="selectedTimeIndex" :index="selectedTimeIndex" :feed="feed"></time-select>

                </div>
            {% endif %}

            <!-- VIDEO COMPONENT -->
            <video-player></video-player>

            {% if page.url contains 'live' %}
                <!-- SURFCAM REPLAYS -->
                <h2 class="d-flex mb-4 mt-5"><i class="fa fa-rotate-left pr-3"></i> Surfcam Replays</h2>

                <!-- WRAPPER -->
                <div class="custom-select-wrapper collapse-row-sm-only mt-0">

                    <!-- DATE-SELECT COMPONENT -->
                    <date-select :is-loading="feedLoading" v-model="date"></date-select>

                    <!-- TIME-SELECT COMPONENT -->
                    <time-select :is-loading="feedLoading" v-model="selectedTimeIndex" :index="selectedTimeIndex" :feed="feed"></time-select>

                </div>
            {% endif %}

            <!-- THUMB-SLIDER COMPONENT -->
            <transition name="special-thumb-slider-entrance">
                <thumb-slider v-if="feed" :is-loading="feedLoading" :feed="feed" :current-index="selectedTimeIndex"></thumb-slider>
            </transition>

        </div>
    </surfcam-widget>

</div> <!-- /.vue-app -->

{% unless page.user_type == 'paid' %}
    {% include ads.html type=2 %}
{% endunless %}

{% comment %}

// SAFE LAYOUT - WORKS - MINIMAL

<div id="vue-app" class="mb-4">

    {% capture live_stream %}
        {% if page.url contains 'live' %}
            live-stream="rtmp://streamer.swellnet.com.au/surfcams/snapper-rocks.stream"
            live-stream-image="http://static.swellnet.com.au/images/surfcams/snapper-rocks.jpg"
            live-stream-playlist="https://streamer.swellnet.com.au/surfcams/yamba.stream/playlist.m3u8"
        {% endif %}
    {% endcapture %}

    <!-- SURFCAM WIDGET -->
    <surfcam-widget {{ live_stream }} data-path="http://staging.swellnet.com.fe2.stg.swellnet.anchor.net.au/surfcam-replays/data/" surfcam-id="33" inline-template>
        <div>
            <!-- LIVE / REPLAYS TABS -->
            <div class="btn-tabs collapse-row-sm-only">
                <a class="btn-tab" :class="{active: feedType == 'replay'}" href="/surfcams/knights-replays/paid/">Replays</a>
                <a class="btn-tab" :class="{active: feedType == 'live'}"   href="/surfcams/knights-live/paid/">Live</a>
            </div>

            <!-- VIDEO COMPONENT -->
            <video-player></video-player>

            <!-- WRAPPER -->
            <div class="custom-select-wrapper collapse-row-sm-only mt-0">

                <!-- DATE-SELECT COMPONENT -->
                <date-select :is-loading="feedLoading" v-model="date"></date-select>

                <!-- TIME-SELECT COMPONENT -->
                <time-select :is-loading="feedLoading" v-model="selectedTimeIndex" :index="selectedTimeIndex" :feed="feed"></time-select>

            </div>

            <!-- THUMB-SLIDER COMPONENT -->
            <transition name="special-thumb-slider-entrance">
                <thumb-slider v-if="feed" :is-loading="feedLoading" :feed="feed" :current-index="selectedTimeIndex"></thumb-slider>
            </transition>

        </div>
    </surfcam-widget>

</div> <!-- /.vue-app -->

{% endcomment %}